<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>ì˜í™” ë¦¬ë·° ìˆ˜ì •</title>
    <link rel="stylesheet" th:href="@{/style.css}" />
    <style>
        .star-rating {
            display: flex;
            flex-direction: row-reverse;
            font-size: 2.25rem;
            line-height: 2.5rem;
            justify-content: space-around;
            padding: 0 0.2em;
            text-align: center;
            width: 5em;
        }



        .star-rating input {
            display: none;
        }



        .star-rating label {
            cursor: pointer;
            filter: grayscale(100%) brightness(0.8);
            transition: filter 0.2s ease;
        }



        .star-rating :checked ~ label {
            filter: grayscale(0%) brightness(1) drop-shadow(0 0 8px rgba(255, 165, 0, 0.5));
        }



        .star-rating label:hover,
        .star-rating label:hover ~ label {
            filter: grayscale(0%) brightness(1.2) drop-shadow(0 0 12px rgba(255, 200, 0, 0.8));
        }
        .photo-box {
            position: relative;
            cursor: pointer;
        }

        .photo-box input[type="file"] {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            cursor: pointer;
        }

        .photo-box span {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            color: #999;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .photo-box:hover span {
            color: #ff8c00;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
<div id="navbar" th:replace="/navbar"></div>



<main class="container">
    <div class="left">
        <div class="photo-box" id="photoBox">
            <img id="movieImg" alt="ì˜í™” í¬ìŠ¤í„°" />
            <input type="file" id="photoInput" accept="image/*" />
        </div>
        <input type="date" class="date" id="watchedDateInput" th:value="${review.watchedDate}"/>
    </div>



    <div class="right">
        <div class="info-row">
            <input type="text" class="movie-title" id="titleInput" th:value="${review.title}"/>
            <div class="star-rating space-x-4 mx-auto">
                <input type="radio" id="5-stars" name="rating" value="5" th:checked="${review.rating == 5}"/>
                <label for="5-stars" class="star pr-4">ğŸŠ</label>



                <input type="radio" id="4-stars" name="rating" value="4" th:checked="${review.rating == 4}"/>
                <label for="4-stars" class="star">ğŸŠ</label>



                <input type="radio" id="3-stars" name="rating" value="3" th:checked="${review.rating == 3}"/>
                <label for="3-stars" class="star">ğŸŠ</label>



                <input type="radio" id="2-stars" name="rating" value="2" th:checked="${review.rating == 2}"/>
                <label for="2-stars" class="star">ğŸŠ</label>



                <input type="radio" id="1-star" name="rating" value="1" th:checked="${review.rating == 1}"/>
                <label for="1-star" class="star">ğŸŠ</label>
            </div>
        </div>
        <input class="review" id="contentInput" th:value="${review.content}">
        <div class="btn-group">
            <button class="btn" id="saveBtn">ìˆ˜ì •ì™„ë£Œ</button>
        </div>
    </div>
</main>



<script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");



    const movieImg = document.getElementById("movieImg");
    const titleInput = document.getElementById("titleInput");
    const watchedDateInput = document.getElementById("watchedDateInput");
    const contentInput = document.getElementById("contentInput");
    const photoInput = document.getElementById("photoInput");



    let selectedRating = 0;



    // ë°±ì—”ë“œì—ì„œ ì˜í™” ë¦¬ë·° ì •ë³´ ê°€ì ¸ì˜¤ê¸°
    fetch(`/api/reviews/${id}`)
      .then(res => res.json())
      .then(review => {
        movieImg.src = review.posterPath || "https://via.placeholder.com/220x260.png?text=í¬ìŠ¤í„°";
        titleInput.value = review.title;
        watchedDateInput.value = review.watchedDate;
        contentInput.value = review.content;
        selectedRating = review.rating || 0;

        // ë³„ì  ì²´í¬
        if(selectedRating > 0) {
          document.getElementById(`${selectedRating}-star${selectedRating > 1 ? 's' : ''}`).checked = true;
        }
      })
      .catch(err => {
        console.error(err);
        document.querySelector("main").innerHTML = "<p>ì˜í™” ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
      });



    // ë³„ì  ì„ íƒ ê°ì§€
    document.querySelectorAll('input[name="rating"]').forEach(radio => {
      radio.addEventListener('change', (e) => {
        selectedRating = parseInt(e.target.value);
      });
    });



    // ìˆ˜ì • ì™„ë£Œ ë²„íŠ¼ í´ë¦­ â†’ PUT ìš”ì²­
    document.getElementById("saveBtn").addEventListener("click", () => {
      const updatedMovie = {
        title: titleInput.value,
        watchedDate: watchedDateInput.value,
        content: contentInput.value,
        posterPath: movieImg.src,
        rating: selectedRating
      };



      fetch(`/api/reviews/update/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(updatedMovie)
      })
      .then(res => {
        if(res.ok){
          alert("ìˆ˜ì • ì™„ë£Œ! í™ˆìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
          window.location.href = "home.html";
        } else {
          alert("ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
      })
      .catch(err => {
        console.error(err);
        alert("ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      });
    });
</script>
</body>
</html>
```



ì£¼ìš” ìˆ˜ì •ì‚¬í•­:



`<style>` íƒœê·¸: React ì½”ë“œë¥¼ ì œê±°í•˜ê³  ìˆœìˆ˜ CSSë¡œ ë³€ê²½ - ê·¤ì´ ê¸°ë³¸ì ìœ¼ë¡œ íšŒìƒ‰ì¡°ë¡œ ë³´ì´ë‹¤ê°€ ì„ íƒ/í˜¸ë²„ ì‹œ ìƒ‰ìƒì´ ë‚˜íƒ€ë‚˜ë„ë¡ `filter` ì†ì„± ì‚¬ìš©
`v-model` ì œê±°: Vue.js ë¬¸ë²•ì´ì—ˆë˜ `v-model`ì„ ì œê±°í•˜ê³  Thymeleafì˜ `th:checked` ì‚¬ìš©
JavaScript: ë³„ì  ì„ íƒì„ ê°ì§€í•˜ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
ì£¼ì„ ì²˜ë¦¬ëœ ì½”ë“œ: ë¶ˆí•„ìš”í•œ ì£¼ì„ ì œê±°í•˜ê³  ì‹¤ì œ ë™ì‘í•˜ëŠ” ì½”ë“œë§Œ ë‚¨ê¹€


ì´ì œ ê·¤ ë ˆì´íŒ…ì´ ì œëŒ€ë¡œ ë™ì‘í•  ê±°ì˜ˆìš”! ğŸŠ

ìŒ ìš°ë¦¬ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—†ì´ í•´ì•¼ë¼ ì™œëƒí•˜ë©´ íƒ€ì„ë¦¬í”„ë¡œ ì—°ê²°í•´ì•¼ë˜ê¸° ë•Œë¬¸ì´ì•¼. ê·¸ë˜ì„œ ìŠ¤í¬ë¦½íŠ¸ë¶€ë¶„ì—ëŠ” ì£¼ì„ì„ ì³¤ì–´
ì•„! ì´í•´í–ˆì–´ìš”. JavaScript ì—†ì´ ìˆœìˆ˜ CSSì™€ Thymeleafë§Œìœ¼ë¡œ ì‘ë™í•´ì•¼ í•˜ëŠ”êµ°ìš”. ê·¸ëŸ¼ CSSë§Œìœ¼ë¡œ ê·¤ ë ˆì´íŒ…ì´ ì‘ë™í•˜ë„ë¡ ìˆ˜ì •í• ê²Œìš”!



```html
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>ì˜í™” ë¦¬ë·° ìˆ˜ì •</title>
    <link rel="stylesheet" th:href="@{/style.css}" />
    <style>
        .star-rating {
            display: flex;
            flex-direction: row-reverse;
            font-size: 2.25rem;
            line-height: 2.5rem;
            justify-content: space-around;
            padding: 0 0.2em;
            text-align: center;
            width: 5em;
        }



        .star-rating input {
            display: none;
        }



        .star-rating label {
            cursor: pointer;
            filter: grayscale(100%) brightness(0.8);
            transition: filter 0.2s ease;
        }



        .star-rating :checked ~ label {
            filter: grayscale(0%) brightness(1) drop-shadow(0 0 8px rgba(255, 165, 0, 0.5));
        }



        .star-rating label:hover,
        .star-rating label:hover ~ label {
            filter: grayscale(0%) brightness(1.2) drop-shadow(0 0 12px rgba(255, 200, 0, 0.8));
        }
</style>
</head>
<body>
<div id="navbar" th:replace="/navbar"></div>



<main class="container">
    <div class="left">
        <div class="photo-box" id="photoBox">
            <img id="movieImg" alt="ì˜í™” í¬ìŠ¤í„°" />
            <input type="file" id="photoInput" accept="image/*" />
        </div>
        <input type="date" class="date" id="watchedDateInput" th:value="${review.watchedDate}"/>
    </div>



    <div class="right">
        <div class="info-row">
            <input type="text" class="movie-title" id="titleInput" th:value="${review.title}"/>
            <div class="star-rating space-x-4 mx-auto">
                <input type="radio" id="5-stars" name="rating" value="5" th:checked="${review.rating == 5}"/>
                <label for="5-stars" class="star pr-4">ğŸŠ</label>



                <input type="radio" id="4-stars" name="rating" value="4" th:checked="${review.rating == 4}"/>
                <label for="4-stars" class="star">ğŸŠ</label>



                <input type="radio" id="3-stars" name="rating" value="3" th:checked="${review.rating == 3}"/>
                <label for="3-stars" class="star">ğŸŠ</label>



                <input type="radio" id="2-stars" name="rating" value="2" th:checked="${review.rating == 2}"/>
                <label for="2-stars" class="star">ğŸŠ</label>



                <input type="radio" id="1-star" name="rating" value="1" th:checked="${review.rating == 1}"/>
                <label for="1-star" class="star">ğŸŠ</label>
            </div>



        </div>
        <input class="review" id="contentInput" th:value="${review.content}">
        <div class="btn-group">
            <button class="btn" id="saveBtn">ìˆ˜ì •ì™„ë£Œ</button>
        </div>
    </div>
</main>


<!-- fetch("navbar.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("navbar").innerHTML = html;

        // navbar.htmlì´ ë¡œë“œëœ ë’¤ì— ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
        document.getElementById("homeBtn").addEventListener("click", () => {
          window.location.href = "home.html";
        });
        document.getElementById("newBtn").addEventListener("click", () => {
          window.location.href = "new.html";
        });
      })
      .catch(err => console.error("ë„¤ë¹„ê²Œì´ì…˜ ë¡œë“œ ì˜¤ë¥˜:", err));


         // URLì—ì„œ id ê°€ì ¸ì˜¤ê¸°
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");

    const movieImg = document.getElementById("movieImg");
    const titleInput = document.getElementById("titleInput");
    const watchedDateInput = document.getElementById("watchedDateInput");
    const contentInput = document.getElementById("contentInput");
    const ratingBox = document.getElementById("ratingBox");
    const photoInput = document.getElementById("photoInput");

    let selectedRating = 0;

    // ë°±ì—”ë“œì—ì„œ ì˜í™” ë¦¬ë·° ì •ë³´ ê°€ì ¸ì˜¤ê¸°
    fetch(`/api/reviews/${id}`)
      .then(res => res.json())
      .then(review => {
        movieImg.src = review.posterPath || "https://via.placeholder.com/220x260.png?text=í¬ìŠ¤í„°";
        titleInput.value = review.title;
        watchedDateInput.value = review.watchedDate;
        contentInput.value = review.content;
        selectedRating = review.rating || 0;
        ratingBox.textContent = "ğŸŠ".repeat(selectedRating);
      })
      .catch(err => {
        console.error(err);
        document.querySelector("main").innerHTML = "<p>ì˜í™” ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
      });


    // ë³„ì  ì„ íƒ
    ratingBox.addEventListener("click", () => {
      selectedRating = prompt("ë³„ì ì„ 1~5ë¡œ ì…ë ¥í•˜ì„¸ìš”") || selectedRating;
      selectedRating = Math.min(Math.max(Number(selectedRating),1),5);
      ratingBox.textContent = "ğŸŠ".repeat(selectedRating);
    });

    // ìˆ˜ì • ì™„ë£Œ ë²„íŠ¼ í´ë¦­ â†’ PUT ìš”ì²­
    document.getElementById("saveBtn").addEventListener("click", () => {
      const updatedMovie = {
        title: titleInput.value,
        watchedDate: watchedDateInput.value,
        content: contentInput.value,
        posterPath: movieImg.src,
        rating: selectedRating
      };

      fetch(`/api/reviews/update/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(updatedMovie)
      })
      .then(res => {
        if(res.ok){
          alert("ìˆ˜ì • ì™„ë£Œ! í™ˆìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
          window.location.href = "home.html";
        } else {
          alert("ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
      })
      .catch(err => {
        console.error(err);
        alert("ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      });
    }); -->
</script>
</body>
</html>